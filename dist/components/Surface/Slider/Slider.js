"use client";import{jsx as e,jsxs as r}from"react/jsx-runtime";import{twMerge as t}from"@rentalhost/nolva-core";import{Children as i,useCallback as o,useEffect as l,useMemo as n,useRef as s,useState as a}from"react";import{FaAngleLeft as d}from"react-icons/fa6";import{Autoplay as c,FreeMode as m,Keyboard as p}from"swiper/modules";import{Swiper as u,SwiperSlide as f}from"swiper/react";import{Pagination as h}from"../../Pagination/Pagination/Pagination.js";import{SliderArrow as v}from"./SliderArrow.js";import{listenWindowEvent as g}from"../../../services/EventService.js";import{useReady as b}from"../../../services/hooks/useReady.js";import{normalizeBreakpoints as y}from"../../../services/SwiperService.js";export function Slider({duration:S=5e3,speed:x=300,items:N=1,gap:k=.5,infinity:w=!0,freeFlow:j=!1,stretch:A=!0,centered:C=!0,className:E,arrowsIcon:M=e(d,{}),arrowsStepMode:P="sequential",arrowsClassName:z,arrowsPlacement:I="overlay",arrowsPlacementFallback:T="overlay",pagination:q="after",paginationClassName:R,paginationCompressed:V=!0,paginationLimit:W,children:B=[],onNavigate:D}){let _=b(),F=s(null),G=s(null),[L,O]=a(0),[X,H]=a(Number.MAX_SAFE_INTEGER),J=n(()=>i.toArray(B).filter(Boolean),[B]),K=n(()=>y(J.length,N,k,A),[J.length,k,N,A]),[Q,U]=a(),[Y,Z]=a(!1),$=n(()=>J.length>X,[J.length,X]),ee=n(()=>$?Y||"external"!==I?I:T:"disabled",[$,I,T,Y]),er=o(e=>{let r="sequential"===P?1:X,t=(L+J.length+e*r)%J.length;Q.slideTo(t),D?.()},[P,L,J.length,D,Q,X]),et=n(()=>V?Math.ceil(J.length/X):J.length,[J.length,V,X]),ei=n(()=>V?et>1:$,[$,V,et]),eo=o(e=>{"number"==typeof e&&H(e)},[]);return l(()=>_?g("resize",()=>{null!==F.current&&null!==G.current&&Z(F.current.offsetWidth+3*G.current.offsetWidth<=document.body.offsetWidth)}):void 0,[_]),_&&r("div",{"data-component":"Slider",className:t("relative",E),children:[r("div",{ref:F,className:"relative flex",children:[e(v,{ref:G,icon:M,className:z,placement:ee,isDisabled:!w&&0===L,onClick:()=>{er(-1)}}),e(u,{onSwiper:U,loop:w&&$,autoplay:0!==S&&{delay:S,pauseOnMouseEnter:!0},breakpoints:K,modules:[c,p,...j?[m]:[]],centerInsufficientSlides:C,freeMode:{enabled:j,sticky:!0},keyboard:{enabled:!0,onlyInViewport:!0},loopAddBlankSlides:!1,speed:x*X,onSlideChange:({realIndex:e})=>{O(e)},onTouchEnd:()=>{D?.()},onAfterInit:e=>{eo(e.params.slidesPerView)},onResize:e=>{eo(e.params.slidesPerView),queueMicrotask(()=>{e.update()})},className:t("flex-1",!Q&&"hidden"),children:J.map((r,t)=>e(f,{children:r},t))}),e(v,{rotate:!0,icon:M,className:z,placement:ee,isDisabled:!w&&0===L,onClick:()=>{er(1)}})]}),ei&&e("div",{className:t("z-10",!1===q&&"hidden","overlay"===q&&"absolute inset-x-0 bottom-0",R),children:e(h,{current:V?L===J.length-X?et:Math.ceil((L+1)/X):L+1,total:et,visibleCount:W,spread:V?void 0:X-1,pageClassName:"text-[size:0] w-2.5",firstLast:!1,previousNext:!1,onClick:e=>{D?.(),Q.slideTo(V?(e-1)*X:e-1)}})})]})}