"use client";import{cloneElement as e}from"react";import{createRoot as r}from"react-dom/client";import{deferPromise as o}from"./PromiseService.js";export async function promisePortal(e){let{promise:t,resolve:n}=o(),m=document.createElement("div"),i=r(m);return i.render(e(n)),document.body.appendChild(m),new Promise(e=>{t.then(e)}).finally(()=>{requestIdleCallback(()=>{i.unmount(),document.body.removeChild(m)})})}export async function promiseElement(r){return promisePortal(o=>e(r,{ref(e){null!==e&&requestAnimationFrame(()=>{o(e)})}}))}